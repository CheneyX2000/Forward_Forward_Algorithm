Forward-Forward Algo test
==================================================

=== base test ===
Sample construction: pos.shape=(794,), neg.shape=(794,)
Positive label position: 3
Negative label position: 5
Random prediction: 9, max_prob: 0.1724
base test passed

=== small scale experiment ===
Loading MNIST dataset...
Train set: (60000, 784), Test set: (10000, 784)
Pixel range: [0.000, 1.000]
Network architecture: [794, 500, 300, 10]

start trainin...
Epoch 1:
  Layer 0: Pos=115.7541, Neg=101.2996, Gap=14.4545
  Layer 1: Pos=149.3728, Neg=127.3688, Gap=22.0040
  Layer 2: Pos=6.1884, Neg=5.5448, Gap=0.6437
  Average total goodness difference: 37.1021
Test accuracy: 0.5950
Logic timer for train time for all layers: 3000
---------------------------------------------------------------
Epoch 2:
  Layer 0: Pos=212.2090, Neg=160.7489, Gap=51.4602
  Layer 1: Pos=230.0935, Neg=175.7324, Gap=54.3611
  Layer 2: Pos=8.0352, Neg=6.3199, Gap=1.7153
  Average total goodness difference: 107.5365
Test accuracy: 0.6390
Logic timer for train time for all layers: 6000
---------------------------------------------------------------
Epoch 3:
  Layer 0: Pos=276.0728, Neg=189.9317, Gap=86.1411
  Layer 1: Pos=257.3695, Neg=172.6593, Gap=84.7102
  Layer 2: Pos=8.9532, Neg=5.7914, Gap=3.1618
  Average total goodness difference: 174.0131
Test accuracy: 0.6330
Logic timer for train time for all layers: 9000
---------------------------------------------------------------
Epoch 4:
  Layer 0: Pos=318.1384, Neg=209.7831, Gap=108.3553
  Layer 1: Pos=273.1714, Neg=174.1247, Gap=99.0467
  Layer 2: Pos=9.3491, Neg=5.7633, Gap=3.5858
  Average total goodness difference: 210.9878
Test accuracy: 0.6830
Logic timer for train time for all layers: 12000
---------------------------------------------------------------
Epoch 5:
  Layer 0: Pos=351.2488, Neg=229.3259, Gap=121.9228
  Layer 1: Pos=281.2511, Neg=179.1698, Gap=102.0814
  Layer 2: Pos=9.5403, Neg=5.7471, Gap=3.7932
  Average total goodness difference: 227.7974
Test accuracy: 0.7060
Logic timer for train time for all layers: 15000
---------------------------------------------------------------
Epoch 6:
  Layer 0: Pos=371.9918, Neg=235.9629, Gap=136.0289
  Layer 1: Pos=284.3300, Neg=177.4333, Gap=106.8967
  Layer 2: Pos=9.5909, Neg=5.6964, Gap=3.8945
  Average total goodness difference: 246.8200
Test accuracy: 0.7390
Logic timer for train time for all layers: 18000
---------------------------------------------------------------
Epoch 7:
  Layer 0: Pos=389.2828, Neg=246.8169, Gap=142.4659
  Layer 1: Pos=286.1299, Neg=180.4631, Gap=105.6668
  Layer 2: Pos=9.6144, Neg=5.6992, Gap=3.9151
  Average total goodness difference: 252.0479
Test accuracy: 0.7270
Logic timer for train time for all layers: 21000
---------------------------------------------------------------
Epoch 8:
  Layer 0: Pos=401.1312, Neg=248.2965, Gap=152.8347
  Layer 1: Pos=286.3677, Neg=175.9337, Gap=110.4339
  Layer 2: Pos=9.6157, Neg=5.5874, Gap=4.0283
  Average total goodness difference: 267.2970
Test accuracy: 0.7290
Logic timer for train time for all layers: 24000
---------------------------------------------------------------
Epoch 9:
  Layer 0: Pos=410.1118, Neg=254.7422, Gap=155.3696
  Layer 1: Pos=286.0738, Neg=178.5567, Gap=107.5171
  Layer 2: Pos=9.5809, Neg=5.5819, Gap=3.9990
  Average total goodness difference: 266.8857
Test accuracy: 0.7360
Logic timer for train time for all layers: 27000
---------------------------------------------------------------
Epoch 10:
  Layer 0: Pos=418.1315, Neg=256.6583, Gap=161.4732
  Layer 1: Pos=286.0831, Neg=177.3782, Gap=108.7049
  Layer 2: Pos=9.5920, Neg=5.5770, Gap=4.0150
  Average total goodness difference: 274.1931
Test accuracy: 0.7440
Logic timer for train time for all layers: 30000
---------------------------------------------------------------

training completed, time used: 318.77 second

=== detailed evaluation ===
accuracy on the test set: 0.7440

sample prediction analysis:
sample0: true_label=7, predicted_label=7, confidence=1.0000
sample1: true_label=2, predicted_label=2, confidence=1.0000
sample2: true_label=1, predicted_label=1, confidence=1.0000
sample3: true_label=0, predicted_label=0, confidence=1.0000
sample4: true_label=4, predicted_label=4, confidence=1.0000

 run performance comparison? type 'y' to continue

=== performance comparison of different architectures ===
Loading MNIST dataset...
Train set: (60000, 784), Test set: (10000, 784)
Pixel range: [0.000, 1.000]

test architecture: [794, 200, 10]
Epoch 1:
  Layer 0: Pos=36.6688, Neg=34.1587, Gap=2.5101
  Layer 1: Pos=3.1328, Neg=2.7734, Gap=0.3594
  Average total goodness difference: 2.8694
Test accuracy: 0.5540
Logic timer for train time for all layers: 1000
---------------------------------------------------------------
Epoch 2:
  Layer 0: Pos=58.7911, Neg=48.4953, Gap=10.2958
  Layer 1: Pos=6.0408, Neg=5.0446, Gap=0.9962
  Average total goodness difference: 11.2920
Test accuracy: 0.5720
Logic timer for train time for all layers: 2000
---------------------------------------------------------------
Epoch 3:
  Layer 0: Pos=80.2709, Neg=61.2418, Gap=19.0290
  Layer 1: Pos=6.9520, Neg=5.4070, Gap=1.5450
  Average total goodness difference: 20.5741
Test accuracy: 0.6000
Logic timer for train time for all layers: 3000
---------------------------------------------------------------
Epoch 4:
  Layer 0: Pos=95.7615, Neg=67.9510, Gap=27.8105
  Layer 1: Pos=7.6135, Neg=5.3848, Gap=2.2288
  Average total goodness difference: 30.0393
Test accuracy: 0.6100
Logic timer for train time for all layers: 4000
---------------------------------------------------------------
Epoch 5:
  Layer 0: Pos=108.8297, Neg=72.7642, Gap=36.0655
  Layer 1: Pos=8.0400, Neg=5.1347, Gap=2.9053
  Average total goodness difference: 38.9708
Test accuracy: 0.6040
Logic timer for train time for all layers: 5000
---------------------------------------------------------------
Epoch 6:
  Layer 0: Pos=119.0529, Neg=76.0438, Gap=43.0091
  Layer 1: Pos=8.4966, Neg=5.1621, Gap=3.3345
  Average total goodness difference: 46.3436
Test accuracy: 0.6340
Logic timer for train time for all layers: 6000
---------------------------------------------------------------
Epoch 7:
  Layer 0: Pos=129.0100, Neg=81.6773, Gap=47.3327
  Layer 1: Pos=8.8420, Neg=5.0826, Gap=3.7594
  Average total goodness difference: 51.0920
Test accuracy: 0.6200
Logic timer for train time for all layers: 7000
---------------------------------------------------------------
Epoch 8:
  Layer 0: Pos=136.1233, Neg=84.2193, Gap=51.9040
  Layer 1: Pos=9.0279, Neg=5.2892, Gap=3.7387
  Average total goodness difference: 55.6427
Test accuracy: 0.6420
Logic timer for train time for all layers: 8000
---------------------------------------------------------------
Epoch 9:
  Layer 0: Pos=142.1226, Neg=86.7404, Gap=55.3822
  Layer 1: Pos=9.2171, Neg=5.3084, Gap=3.9087
  Average total goodness difference: 59.2909
Test accuracy: 0.6360
Logic timer for train time for all layers: 9000
---------------------------------------------------------------
Epoch 10:
  Layer 0: Pos=147.5029, Neg=90.1424, Gap=57.3606
  Layer 1: Pos=9.2993, Neg=5.4749, Gap=3.8244
  Average total goodness difference: 61.1850
Test accuracy: 0.6160
Logic timer for train time for all layers: 10000
---------------------------------------------------------------
accuracy: 0.6160, training time: 60.39 second

test architecture: [794, 500, 300, 10]
Epoch 1:
  Layer 0: Pos=94.5820, Neg=87.9997, Gap=6.5822
  Layer 1: Pos=108.0956, Neg=94.9442, Gap=13.1514
  Layer 2: Pos=4.6998, Neg=4.2259, Gap=0.4739
  Average total goodness difference: 20.2075
Test accuracy: 0.6280
Logic timer for train time for all layers: 1500
---------------------------------------------------------------
Epoch 2:
  Layer 0: Pos=150.2012, Neg=124.0317, Gap=26.1695
  Layer 1: Pos=197.8389, Neg=164.4059, Gap=33.4330
  Layer 2: Pos=7.4996, Neg=6.6347, Gap=0.8649
  Average total goodness difference: 60.4674
Test accuracy: 0.6000
Logic timer for train time for all layers: 3000
---------------------------------------------------------------
Epoch 3:
  Layer 0: Pos=201.8910, Neg=155.1028, Gap=46.7882
  Layer 1: Pos=226.9648, Neg=174.2172, Gap=52.7477
  Layer 2: Pos=8.3178, Neg=6.6623, Gap=1.6555
  Average total goodness difference: 101.1915
Test accuracy: 0.6040
Logic timer for train time for all layers: 4500
---------------------------------------------------------------
Epoch 4:
  Layer 0: Pos=243.1594, Neg=173.2002, Gap=69.9592
  Layer 1: Pos=241.4154, Neg=169.4491, Gap=71.9663
  Layer 2: Pos=8.5851, Neg=6.0761, Gap=2.5090
  Average total goodness difference: 144.4345
Test accuracy: 0.6800
Logic timer for train time for all layers: 6000
---------------------------------------------------------------
Epoch 5:
  Layer 0: Pos=274.9753, Neg=185.7470, Gap=89.2283
  Layer 1: Pos=259.1065, Neg=169.4247, Gap=89.6818
  Layer 2: Pos=9.3094, Neg=5.7173, Gap=3.5921
  Average total goodness difference: 182.5021
Test accuracy: 0.6160
Logic timer for train time for all layers: 7500
---------------------------------------------------------------
Epoch 6:
  Layer 0: Pos=301.9147, Neg=196.2890, Gap=105.6258
  Layer 1: Pos=269.2784, Neg=168.4755, Gap=100.8029
  Layer 2: Pos=9.5679, Neg=5.6486, Gap=3.9193
  Average total goodness difference: 210.3480
Test accuracy: 0.6240
Logic timer for train time for all layers: 9000
---------------------------------------------------------------
Epoch 7:
  Layer 0: Pos=324.8159, Neg=205.1882, Gap=119.6277
  Layer 1: Pos=277.2086, Neg=171.0742, Gap=106.1344
  Layer 2: Pos=9.6396, Neg=5.7938, Gap=3.8458
  Average total goodness difference: 229.6078
Test accuracy: 0.5880
Logic timer for train time for all layers: 10500
---------------------------------------------------------------
Epoch 8:
  Layer 0: Pos=342.9951, Neg=214.9627, Gap=128.0325
  Layer 1: Pos=282.6441, Neg=176.2233, Gap=106.4208
  Layer 2: Pos=9.6575, Neg=5.9652, Gap=3.6923
  Average total goodness difference: 238.1455
Test accuracy: 0.6540
Logic timer for train time for all layers: 12000
---------------------------------------------------------------
Epoch 9:
  Layer 0: Pos=358.7131, Neg=222.2006, Gap=136.5124
  Layer 1: Pos=285.0165, Neg=174.9036, Gap=110.1129
  Layer 2: Pos=9.6520, Neg=5.7891, Gap=3.8630
  Average total goodness difference: 250.4883
Test accuracy: 0.6820
Logic timer for train time for all layers: 13500
---------------------------------------------------------------
Epoch 10:
  Layer 0: Pos=371.5894, Neg=225.4890, Gap=146.1004
  Layer 1: Pos=287.5728, Neg=172.2287, Gap=115.3441
  Layer 2: Pos=9.7143, Neg=5.5481, Gap=4.1662
  Average total goodness difference: 265.6106
Test accuracy: 0.6800
Logic timer for train time for all layers: 15000
---------------------------------------------------------------
accuracy: 0.6800, training time: 201.88 second

test architecture: [794, 800, 400, 200, 10]
Epoch 1:
  Layer 0: Pos=149.3479, Neg=139.6753, Gap=9.6726
  Layer 1: Pos=163.2241, Neg=143.4502, Gap=19.7739
  Layer 2: Pos=105.5215, Neg=95.1388, Gap=10.3827
  Layer 3: Pos=5.8624, Neg=5.4095, Gap=0.4529
  Average total goodness difference: 40.2820
Test accuracy: 0.6220
Logic timer for train time for all layers: 2000
---------------------------------------------------------------
Epoch 2:
  Layer 0: Pos=234.3732, Neg=193.6297, Gap=40.7436
  Layer 1: Pos=273.1584, Neg=230.8932, Gap=42.2653
  Layer 2: Pos=149.5441, Neg=132.0092, Gap=17.5349
  Layer 3: Pos=7.2341, Neg=6.5055, Gap=0.7286
  Average total goodness difference: 101.2724
Test accuracy: 0.6380
Logic timer for train time for all layers: 4000
---------------------------------------------------------------
Epoch 3:
  Layer 0: Pos=315.0099, Neg=236.9016, Gap=78.1083
  Layer 1: Pos=312.5659, Neg=250.9866, Gap=61.5793
  Layer 2: Pos=161.5441, Neg=133.2707, Gap=28.2733
  Layer 3: Pos=7.6726, Neg=6.2435, Gap=1.4291
  Average total goodness difference: 169.3900
Test accuracy: 0.5800
Logic timer for train time for all layers: 6000
---------------------------------------------------------------
Epoch 4:
  Layer 0: Pos=382.5443, Neg=268.7312, Gap=113.8130
  Layer 1: Pos=340.0983, Neg=262.6292, Gap=77.4691
  Layer 2: Pos=171.6119, Neg=128.9504, Gap=42.6615
  Layer 3: Pos=8.1707, Neg=5.7976, Gap=2.3731
  Average total goodness difference: 236.3168
Test accuracy: 0.6620
Logic timer for train time for all layers: 8000
---------------------------------------------------------------
Epoch 5:
  Layer 0: Pos=437.8648, Neg=297.3212, Gap=140.5436
  Layer 1: Pos=355.7286, Neg=265.9439, Gap=89.7847
  Layer 2: Pos=183.5800, Neg=128.1527, Gap=55.4274
  Layer 3: Pos=9.0164, Neg=5.9239, Gap=3.0925
  Average total goodness difference: 288.8482
Test accuracy: 0.6620
Logic timer for train time for all layers: 10000
---------------------------------------------------------------
Epoch 6:
  Layer 0: Pos=477.7361, Neg=306.8735, Gap=170.8626
  Layer 1: Pos=365.3611, Neg=257.6869, Gap=107.6742
  Layer 2: Pos=188.2734, Neg=121.1357, Gap=67.1377
  Layer 3: Pos=9.3586, Neg=5.7408, Gap=3.6178
  Average total goodness difference: 349.2923
Test accuracy: 0.6480
Logic timer for train time for all layers: 12000
---------------------------------------------------------------
Epoch 7:
  Layer 0: Pos=515.0932, Neg=322.5996, Gap=192.4936
  Layer 1: Pos=374.8171, Neg=261.7335, Gap=113.0835
  Layer 2: Pos=190.9501, Neg=124.4287, Gap=66.5214
  Layer 3: Pos=9.4498, Neg=5.8450, Gap=3.6047
  Average total goodness difference: 375.7033
Test accuracy: 0.6180
Logic timer for train time for all layers: 14000
---------------------------------------------------------------
Epoch 8:
  Layer 0: Pos=544.8186, Neg=333.4682, Gap=211.3504
  Layer 1: Pos=379.2708, Neg=254.1181, Gap=125.1527
  Layer 2: Pos=193.0577, Neg=120.0980, Gap=72.9597
  Layer 3: Pos=9.5705, Neg=5.7081, Gap=3.8624
  Average total goodness difference: 413.3253
Test accuracy: 0.6700
Logic timer for train time for all layers: 16000
---------------------------------------------------------------
Epoch 9:
  Layer 0: Pos=570.9222, Neg=347.6384, Gap=223.2839
  Layer 1: Pos=382.9638, Neg=257.5580, Gap=125.4057
  Layer 2: Pos=193.1865, Neg=121.6292, Gap=71.5573
  Layer 3: Pos=9.5743, Neg=5.7985, Gap=3.7758
  Average total goodness difference: 424.0226
Test accuracy: 0.6160
Logic timer for train time for all layers: 18000
---------------------------------------------------------------
Epoch 10:
  Layer 0: Pos=589.6475, Neg=358.5053, Gap=231.1422
  Layer 1: Pos=384.7649, Neg=260.3690, Gap=124.3959
  Layer 2: Pos=194.1431, Neg=122.4674, Gap=71.6757
  Layer 3: Pos=9.6198, Neg=5.8054, Gap=3.8144
  Average total goodness difference: 431.0282
Test accuracy: 0.6480
Logic timer for train time for all layers: 20000
---------------------------------------------------------------
accuracy: 0.6480, training time: 264.75 second

=== performance comparison of different architectures  ===
architecture		number_of_layer	paremeter_number	accuracy	training_time
------------------------------------------------------------
[794, 200, 10]      	2	160800	0.6160	60.39s
[794, 500, 300, 10] 	3	550000	0.6800	201.88s
[794, 800, 400, 200,	4	1037200	0.6480	264.75s

test completed
